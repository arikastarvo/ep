- name: event
  pattern: (?P<data>.+)
  order: 1

- name: apache-access
  order: 2
  pattern: (?P<dsthost>[^:\s]+):%{INT:dstport}\s%{NOTSPACE:srcip}\s\S+\s\S+\s\[%{HTTPDATE:srctime_unparsed}\]\s\"(?P<http_method>\w+)\s(?P<http_path>\S+)\s(?P<http_version>\S+?)\"\s(?P<http_response_status>[0-9]+)\s(?P<http_response_size>[0-9]+)\s\"(?P<http_referer>.*?)\"\s\"(?P<http_ua>.*?)\"
  parent: event

- name: auditd
  parent: event
  order: 2
  pattern: ^%{SYSLOGTIMESTAMP:srctime}\s%{HOSTNAME:host}\s(?P<program>[\x21-\x5a\x5c\x5e-\x7e]+)(\[(?P<pid>[0-9]+)\])?:%{GREEDYDATA:data}$

- name: systemd
  parent: auditd
  order: 3
  cond:
    program: systemd
  pattern: ^%{GREEDYDATA:data}$
  optionalpattern:
    - (?P<action>Started Session) %{INT:session_id} of user %{NOTSPACE:user}

- name: rsyslogd
  parent: auditd
  order: 3
  cond:
    program: rsyslogd
  pattern: ^%{GREEDYDATA:data}$
  optionalpattern:
    - \sswVersion=\"(?P<version>[^\"\s]+)\"
    - \sx-pid=\"(?P<pid>[0-9]+)\"
    - \s(?P<action>rsyslogd was HUPed)$
    - \s(?P<action>start)$
